<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: SparkleFormation::Provider::Azure
  
    &mdash; SparkleFormation
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "SparkleFormation::Provider::Azure";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (A)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../SparkleFormation.html" title="SparkleFormation (class)">SparkleFormation</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Provider.html" title="SparkleFormation::Provider (module)">Provider</a></span></span>
     &raquo; 
    <span class="title">Azure</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: SparkleFormation::Provider::Azure
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/sparkle_formation/provider/azure.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>Azure specific implementation</p>


  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#apply_deep_nesting-instance_method" title="#apply_deep_nesting (instance method)">#<strong>apply_deep_nesting</strong>(*args) {|stack, resource, s_name| ... } &#x21d2; SparkleFormation::SparkleStruct </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Apply deeply nested stacks.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#apply_shallow_nesting-instance_method" title="#apply_shallow_nesting (instance method)">#<strong>apply_shallow_nesting</strong>(*args) {|resource_name, stack| ... } &#x21d2; SparkleFormation::SparkleStruct </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Apply shallow nesting.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#generate_policy-instance_method" title="#generate_policy (instance method)">#<strong>generate_policy</strong>  &#x21d2; Hash </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Generate policy for stack.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#make_output_available-instance_method" title="#make_output_available (instance method)">#<strong>make_output_available</strong>(output_name, outputs)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Extract output to make available for stack parameter usage at the current depth.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remap_nested_parameters-instance_method" title="#remap_nested_parameters (instance method)">#<strong>remap_nested_parameters</strong>(template, parameters, stack_name, stack_resource, output_map)  &#x21d2; TrueClass </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Extract parameters from nested stacks.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_compiled_state-instance_method" title="#set_compiled_state (instance method)">#<strong>set_compiled_state</strong>(compiled)  &#x21d2; AttributeStruct </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Set the current compile_state into the compiled result.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#stack_resource_type-instance_method" title="#stack_resource_type (instance method)">#<strong>stack_resource_type</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Type string for Azure Resource Manager stack resource.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="apply_deep_nesting-instance_method">
  
    #<strong>apply_deep_nesting</strong>(*args) {|stack, resource, s_name| ... } &#x21d2; <tt><span class='object_link'><a href="../SparkleStruct.html" title="SparkleFormation::SparkleStruct (class)">SparkleFormation::SparkleStruct</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Apply deeply nested stacks. This is the new nesting approach and
does not bubble parameters up to the root stack. Parameters are
isolated to the stack resource itself and output mapping is
automatically applied.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>stack</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../SparkleFormation.html" title="SparkleFormation (class)">SparkleFormation</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>stack instance</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>resource</span>
      
      
        <span class='type'>(<tt>AttributeStruct</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the stack resource</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>s_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>stack resource name</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Yield Returns:</p>
<ul class="yieldreturn">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>key/values to be merged into resource properties</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../SparkleStruct.html" title="SparkleFormation::SparkleStruct (class)">SparkleFormation::SparkleStruct</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>compiled structure</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/sparkle_formation/provider/azure.rb', line 41</span>

<span class='kw'>def</span> <span class='id identifier rubyid_apply_deep_nesting'>apply_deep_nesting</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_outputs'>outputs</span> <span class='op'>=</span> <span class='id identifier rubyid_collect_outputs'>collect_outputs</span>
  <span class='id identifier rubyid_nested_stacks'>nested_stacks</span><span class='lparen'>(</span><span class='symbol'>:with_resource</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_stack'>stack</span><span class='comma'>,</span> <span class='id identifier rubyid_resource'>resource</span><span class='op'>|</span>
    <span class='kw'>unless</span> <span class='id identifier rubyid_stack'>stack</span><span class='period'>.</span><span class='id identifier rubyid_nested_stacks'>nested_stacks</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
      <span class='id identifier rubyid_stack'>stack</span><span class='period'>.</span><span class='id identifier rubyid_apply_deep_nesting'>apply_deep_nesting</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='kw'>unless</span> <span class='id identifier rubyid_stack'>stack</span><span class='period'>.</span><span class='id identifier rubyid_root?'>root?</span>
      <span class='id identifier rubyid_stack'>stack</span><span class='period'>.</span><span class='id identifier rubyid_compile'>compile</span><span class='period'>.</span><span class='id identifier rubyid_parameters'>parameters</span><span class='period'>.</span><span class='id identifier rubyid_keys!'>keys!</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_parameter_name'>parameter_name</span><span class='op'>|</span>
        <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_stack'>stack</span><span class='period'>.</span><span class='id identifier rubyid_compile'>compile</span><span class='period'>.</span><span class='id identifier rubyid_parameters'>parameters</span><span class='period'>.</span><span class='id identifier rubyid_set!'>set!</span><span class='lparen'>(</span><span class='id identifier rubyid_parameter_name'>parameter_name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_stack_unique'>stack_unique</span> <span class='op'>==</span> <span class='kw'>true</span>
        <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_stack'>stack</span><span class='period'>.</span><span class='id identifier rubyid_parent'>parent</span><span class='period'>.</span><span class='id identifier rubyid_compile'>compile</span><span class='period'>.</span><span class='id identifier rubyid_parameters'>parameters</span><span class='period'>.</span><span class='id identifier rubyid_data!'>data!</span><span class='lbracket'>[</span><span class='id identifier rubyid_parameter_name'>parameter_name</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
          <span class='id identifier rubyid_resource'>resource</span><span class='period'>.</span><span class='id identifier rubyid_properties'>properties</span><span class='period'>.</span><span class='id identifier rubyid_parameters'>parameters</span><span class='period'>.</span><span class='id identifier rubyid_set!'>set!</span><span class='lparen'>(</span><span class='id identifier rubyid_parameter_name'>parameter_name</span><span class='comma'>,</span> <span class='id identifier rubyid_resource'>resource</span><span class='period'>.</span><span class='id identifier rubyid_ref!'>ref!</span><span class='lparen'>(</span><span class='id identifier rubyid_parameter_name'>parameter_name</span><span class='rparen'>)</span><span class='rparen'>)</span>
        <span class='kw'>elsif</span> <span class='id identifier rubyid_output_name'>output_name</span> <span class='op'>=</span> <span class='id identifier rubyid_output_matched?'>output_matched?</span><span class='lparen'>(</span><span class='id identifier rubyid_parameter_name'>parameter_name</span><span class='comma'>,</span> <span class='id identifier rubyid_outputs'>outputs</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='rparen'>)</span>
          <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_outputs'>outputs</span><span class='lbracket'>[</span><span class='id identifier rubyid_output_name'>output_name</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_stack'>stack</span>
          <span class='id identifier rubyid_stack_output'>stack_output</span> <span class='op'>=</span> <span class='id identifier rubyid_stack'>stack</span><span class='period'>.</span><span class='id identifier rubyid_make_output_available'>make_output_available</span><span class='lparen'>(</span><span class='id identifier rubyid_output_name'>output_name</span><span class='comma'>,</span> <span class='id identifier rubyid_outputs'>outputs</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_resource'>resource</span><span class='period'>.</span><span class='id identifier rubyid_properties'>properties</span><span class='period'>.</span><span class='id identifier rubyid_parameters'>parameters</span><span class='period'>.</span><span class='id identifier rubyid_set!'>set!</span><span class='lparen'>(</span><span class='id identifier rubyid_parameter_name'>parameter_name</span><span class='comma'>,</span> <span class='id identifier rubyid_stack_output'>stack_output</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='id identifier rubyid_extract_templates'>extract_templates</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_compile'>compile</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="apply_shallow_nesting-instance_method">
  
    #<strong>apply_shallow_nesting</strong>(*args) {|resource_name, stack| ... } &#x21d2; <tt><span class='object_link'><a href="../SparkleStruct.html" title="SparkleFormation::SparkleStruct (class)">SparkleFormation::SparkleStruct</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Apply shallow nesting. This style of nesting will bubble
parameters up to the root stack. This type of nesting is the
original and now deprecated, but remains for compat issues so any
existing usage won&#39;t be automatically busted.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>resource_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>name of stack resource</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>stack</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../SparkleFormation.html" title="SparkleFormation (class)">SparkleFormation</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>nested stack</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Yield Returns:</p>
<ul class="yieldreturn">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>Remote URL storage for template</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../SparkleStruct.html" title="SparkleFormation::SparkleStruct (class)">SparkleFormation::SparkleStruct</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>compiled structure</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


75
76
77
78
79
80
81
82
83
84
85
86
87
88</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/sparkle_formation/provider/azure.rb', line 75</span>

<span class='kw'>def</span> <span class='id identifier rubyid_apply_shallow_nesting'>apply_shallow_nesting</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_parameters'>parameters</span> <span class='op'>=</span> <span class='id identifier rubyid_compile'>compile</span><span class='period'>.</span><span class='id identifier rubyid_parameters'>parameters</span>
  <span class='id identifier rubyid_output_map'>output_map</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_nested_stacks'>nested_stacks</span><span class='lparen'>(</span><span class='symbol'>:with_resource</span><span class='comma'>,</span> <span class='symbol'>:with_name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid__stack'>_stack</span><span class='comma'>,</span> <span class='id identifier rubyid_stack_resource'>stack_resource</span><span class='comma'>,</span> <span class='id identifier rubyid_stack_name'>stack_name</span><span class='op'>|</span>
    <span class='id identifier rubyid_remap_nested_parameters'>remap_nested_parameters</span><span class='lparen'>(</span><span class='id identifier rubyid_compile'>compile</span><span class='comma'>,</span> <span class='id identifier rubyid_parameters'>parameters</span><span class='comma'>,</span> <span class='id identifier rubyid_stack_name'>stack_name</span><span class='comma'>,</span> <span class='id identifier rubyid_stack_resource'>stack_resource</span><span class='comma'>,</span> <span class='id identifier rubyid_output_map'>output_map</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_extract_templates'>extract_templates</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='symbol'>:bubble_outputs</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_output_map'>output_map</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_o_name'>o_name</span><span class='comma'>,</span> <span class='id identifier rubyid_o_val'>o_val</span><span class='op'>|</span>
      <span class='id identifier rubyid_compile'>compile</span><span class='period'>.</span><span class='id identifier rubyid_outputs'>outputs</span><span class='period'>.</span><span class='id identifier rubyid__set'>_set</span><span class='lparen'>(</span><span class='id identifier rubyid_o_name'>o_name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span> <span class='id identifier rubyid_compile'>compile</span><span class='period'>.</span><span class='id identifier rubyid__stack_output'>_stack_output</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_o_val'>o_val</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_compile'>compile</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="generate_policy-instance_method">
  
    #<strong>generate_policy</strong>  &#x21d2; <tt>Hash</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Generate policy for stack</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


16
17
18</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/sparkle_formation/provider/azure.rb', line 16</span>

<span class='kw'>def</span> <span class='id identifier rubyid_generate_policy'>generate_policy</span>
  <span class='lbrace'>{</span><span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="make_output_available-instance_method">
  
    #<strong>make_output_available</strong>(output_name, outputs)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Extract output to make available for stack parameter usage at the
current depth</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>output_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>name of output</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>outputs</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>listing of outputs</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/sparkle_formation/provider/azure.rb', line 96</span>

<span class='kw'>def</span> <span class='id identifier rubyid_make_output_available'>make_output_available</span><span class='lparen'>(</span><span class='id identifier rubyid_output_name'>output_name</span><span class='comma'>,</span> <span class='id identifier rubyid_outputs'>outputs</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_bubble_path'>bubble_path</span> <span class='op'>=</span> <span class='id identifier rubyid_outputs'>outputs</span><span class='lbracket'>[</span><span class='id identifier rubyid_output_name'>output_name</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_root_path'>root_path</span> <span class='op'>-</span> <span class='id identifier rubyid_root_path'>root_path</span>
  <span class='id identifier rubyid_drip_path'>drip_path</span> <span class='op'>=</span> <span class='id identifier rubyid_root_path'>root_path</span> <span class='op'>-</span> <span class='id identifier rubyid_outputs'>outputs</span><span class='lbracket'>[</span><span class='id identifier rubyid_output_name'>output_name</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_root_path'>root_path</span>
  <span class='id identifier rubyid_bubble_path'>bubble_path</span><span class='period'>.</span><span class='id identifier rubyid_each_slice'>each_slice</span><span class='lparen'>(</span><span class='int'>2</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_base_sparkle'>base_sparkle</span><span class='comma'>,</span> <span class='id identifier rubyid_ref_sparkle'>ref_sparkle</span><span class='op'>|</span>
    <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_ref_sparkle'>ref_sparkle</span>
    <span class='id identifier rubyid_base_sparkle'>base_sparkle</span><span class='period'>.</span><span class='id identifier rubyid_compile'>compile</span><span class='period'>.</span><span class='id identifier rubyid_outputs'>outputs</span><span class='period'>.</span><span class='id identifier rubyid__set'>_set</span><span class='lparen'>(</span><span class='id identifier rubyid_output_name'>output_name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid__set'>_set</span><span class='lparen'>(</span>
      <span class='symbol'>:value</span><span class='comma'>,</span> <span class='id identifier rubyid_base_sparkle'>base_sparkle</span><span class='period'>.</span><span class='id identifier rubyid_compile'>compile</span><span class='period'>.</span><span class='id identifier rubyid__stack_output'>_stack_output</span><span class='lparen'>(</span>
        <span class='id identifier rubyid_ref_sparkle'>ref_sparkle</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_output_name'>output_name</span>
      <span class='rparen'>)</span>
    <span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_bubble_path'>bubble_path</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_drip_path'>drip_path</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>1</span>
      <span class='id identifier rubyid_parent'>parent</span> <span class='op'>=</span> <span class='id identifier rubyid_drip_path'>drip_path</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_parent'>parent</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_parent'>parent</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_parent'>parent</span><span class='period'>.</span><span class='id identifier rubyid_compile'>compile</span><span class='period'>.</span><span class='id identifier rubyid_parameters'>parameters</span><span class='period'>.</span><span class='id identifier rubyid__set'>_set</span><span class='lparen'>(</span><span class='id identifier rubyid_output_name'>output_name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
        <span class='kw'>return</span> <span class='id identifier rubyid_compile'>compile</span><span class='period'>.</span><span class='id identifier rubyid_parameter!'>parameter!</span><span class='lparen'>(</span><span class='id identifier rubyid_output_name'>output_name</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Failed to detect available bubbling path for output `</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_output_name'>output_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>`. </span><span class='tstring_end'>&quot;</span></span> <span class='op'>&lt;&lt;</span>
                              <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>This may be due to a circular dependency! </span><span class='tstring_end'>&quot;</span></span> <span class='op'>&lt;&lt;</span>
                              <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(Output Path: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_outputs'>outputs</span><span class='lbracket'>[</span><span class='id identifier rubyid_output_name'>output_name</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_root_path'>root_path</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> &gt; </span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span> <span class='op'>&lt;&lt;</span>
                              <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Requester Path: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_root_path'>root_path</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> &gt; </span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_compile'>compile</span><span class='period'>.</span><span class='id identifier rubyid__stack_output'>_stack_output</span><span class='lparen'>(</span><span class='id identifier rubyid_bubble_path'>bubble_path</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_output_name'>output_name</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_drip_path'>drip_path</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;</span> <span class='int'>1</span>
    <span class='id identifier rubyid_parent'>parent</span> <span class='op'>=</span> <span class='id identifier rubyid_drip_path'>drip_path</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_parent'>parent</span>
    <span class='id identifier rubyid_drip_path'>drip_path</span><span class='period'>.</span><span class='id identifier rubyid_unshift'>unshift</span><span class='lparen'>(</span><span class='id identifier rubyid_parent'>parent</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_parent'>parent</span>
    <span class='id identifier rubyid_drip_path'>drip_path</span><span class='period'>.</span><span class='id identifier rubyid_each_slice'>each_slice</span><span class='lparen'>(</span><span class='int'>2</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_base_sparkle'>base_sparkle</span><span class='comma'>,</span> <span class='id identifier rubyid_ref_sparkle'>ref_sparkle</span><span class='op'>|</span>
      <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_ref_sparkle'>ref_sparkle</span>
      <span class='id identifier rubyid_base_sparkle'>base_sparkle</span><span class='period'>.</span><span class='id identifier rubyid_compile'>compile</span><span class='period'>.</span><span class='id identifier rubyid_resources'>resources</span><span class='lbracket'>[</span><span class='id identifier rubyid_ref_sparkle'>ref_sparkle</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_properties'>properties</span><span class='period'>.</span><span class='id identifier rubyid_parameters'>parameters</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid__set'>_set</span><span class='lparen'>(</span><span class='id identifier rubyid_output_name'>output_name</span><span class='comma'>,</span> <span class='id identifier rubyid_result'>result</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_ref_sparkle'>ref_sparkle</span><span class='period'>.</span><span class='id identifier rubyid_compile'>compile</span><span class='period'>.</span><span class='id identifier rubyid_parameters'>parameters</span><span class='period'>.</span><span class='id identifier rubyid__set'>_set</span><span class='lparen'>(</span><span class='id identifier rubyid_output_name'>output_name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>string</span><span class='tstring_end'>&quot;</span></span> <span class='comment'># TODO: &lt;&lt;&lt;&lt;------ type check and prop
</span>      <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_compile'>compile</span><span class='period'>.</span><span class='id identifier rubyid__parameter'>_parameter</span><span class='lparen'>(</span><span class='id identifier rubyid_output_name'>output_name</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="remap_nested_parameters-instance_method">
  
    #<strong>remap_nested_parameters</strong>(template, parameters, stack_name, stack_resource, output_map)  &#x21d2; <tt>TrueClass</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'><p>if parameter has includes <code>StackUnique</code> a new parameter will
be added to container stack and it will not use outputs</p>
</div>
  </div>

<p>Extract parameters from nested stacks. Check for previous nested
stack outputs that match parameter. If match, set parameter to use
output. If no match, check container stack parameters for match.
If match, set to use ref. If no match, add parameter to container
stack parameters and set to use ref.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>template</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>template being processed</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>parameters</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>top level parameter set being built</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>stack_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>name of stack resource</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>stack_resource</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>duplicate of stack resource contents</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>output_map</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>mapping of output names to required stack output access</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>TrueClass</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/sparkle_formation/provider/azure.rb', line 147</span>

<span class='kw'>def</span> <span class='id identifier rubyid_remap_nested_parameters'>remap_nested_parameters</span><span class='lparen'>(</span><span class='id identifier rubyid_template'>template</span><span class='comma'>,</span> <span class='id identifier rubyid_parameters'>parameters</span><span class='comma'>,</span> <span class='id identifier rubyid_stack_name'>stack_name</span><span class='comma'>,</span> <span class='id identifier rubyid_stack_resource'>stack_resource</span><span class='comma'>,</span> <span class='id identifier rubyid_output_map'>output_map</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_nested_template'>nested_template</span> <span class='op'>=</span> <span class='id identifier rubyid_stack_resource'>stack_resource</span><span class='period'>.</span><span class='id identifier rubyid_properties'>properties</span><span class='period'>.</span><span class='id identifier rubyid_stack'>stack</span><span class='period'>.</span><span class='id identifier rubyid_compile'>compile</span>
  <span class='id identifier rubyid_stack_parameters'>stack_parameters</span> <span class='op'>=</span> <span class='id identifier rubyid_nested_template'>nested_template</span><span class='period'>.</span><span class='id identifier rubyid_parameters'>parameters</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_stack_parameters'>stack_parameters</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_stack_parameters'>stack_parameters</span><span class='period'>.</span><span class='id identifier rubyid__keys'>_keys</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pname'>pname</span><span class='op'>|</span>
      <span class='id identifier rubyid_pval'>pval</span> <span class='op'>=</span> <span class='id identifier rubyid_stack_parameters'>stack_parameters</span><span class='lbracket'>[</span><span class='id identifier rubyid_pname'>pname</span><span class='rbracket'>]</span>
      <span class='kw'>unless</span> <span class='id identifier rubyid_pval'>pval</span><span class='period'>.</span><span class='id identifier rubyid_stack_unique'>stack_unique</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
        <span class='id identifier rubyid_check_name'>check_name</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_stack_name'>stack_name</span><span class='comma'>,</span> <span class='id identifier rubyid_pname'>pname</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_check_name'>check_name</span> <span class='op'>=</span> <span class='id identifier rubyid_pname'>pname</span>
      <span class='kw'>end</span>
      <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_parameters'>parameters</span><span class='period'>.</span><span class='id identifier rubyid__set'>_set</span><span class='lparen'>(</span><span class='id identifier rubyid_check_name'>check_name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
        <span class='id identifier rubyid_template'>template</span><span class='period'>.</span><span class='id identifier rubyid_resources'>resources</span><span class='period'>.</span><span class='id identifier rubyid__set'>_set</span><span class='lparen'>(</span><span class='id identifier rubyid_stack_name'>stack_name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_properties'>properties</span><span class='period'>.</span><span class='id identifier rubyid_parameters'>parameters</span><span class='period'>.</span><span class='id identifier rubyid__set'>_set</span><span class='lparen'>(</span><span class='id identifier rubyid_pname'>pname</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span>
          <span class='id identifier rubyid_template'>template</span><span class='period'>.</span><span class='id identifier rubyid__parameter'>_parameter</span><span class='lparen'>(</span><span class='id identifier rubyid_check_name'>check_name</span><span class='rparen'>)</span>
        <span class='rparen'>)</span>
      <span class='kw'>elsif</span> <span class='id identifier rubyid_output_map'>output_map</span><span class='lbracket'>[</span><span class='id identifier rubyid_check_name'>check_name</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_template'>template</span><span class='period'>.</span><span class='id identifier rubyid_resources'>resources</span><span class='period'>.</span><span class='id identifier rubyid__set'>_set</span><span class='lparen'>(</span><span class='id identifier rubyid_stack_name'>stack_name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_properties'>properties</span><span class='period'>.</span><span class='id identifier rubyid_parameters'>parameters</span><span class='period'>.</span><span class='id identifier rubyid__set'>_set</span><span class='lparen'>(</span><span class='id identifier rubyid_pname'>pname</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span>
          <span class='id identifier rubyid_template'>template</span><span class='period'>.</span><span class='id identifier rubyid__stack_output'>_stack_output</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_output_map'>output_map</span><span class='lbracket'>[</span><span class='id identifier rubyid_check_name'>check_name</span><span class='rbracket'>]</span><span class='rparen'>)</span>
        <span class='rparen'>)</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_parameters'>parameters</span><span class='period'>.</span><span class='id identifier rubyid__set'>_set</span><span class='lparen'>(</span><span class='id identifier rubyid_check_name'>check_name</span><span class='comma'>,</span> <span class='id identifier rubyid_pval'>pval</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_template'>template</span><span class='period'>.</span><span class='id identifier rubyid_resources'>resources</span><span class='period'>.</span><span class='id identifier rubyid__set'>_set</span><span class='lparen'>(</span><span class='id identifier rubyid_stack_name'>stack_name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_properties'>properties</span><span class='period'>.</span><span class='id identifier rubyid_parameters'>parameters</span><span class='period'>.</span><span class='id identifier rubyid__set'>_set</span><span class='lparen'>(</span><span class='id identifier rubyid_pname'>pname</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span>
          <span class='id identifier rubyid_template'>template</span><span class='period'>.</span><span class='id identifier rubyid__parameter'>_parameter</span><span class='lparen'>(</span><span class='id identifier rubyid_check_name'>check_name</span><span class='rparen'>)</span>
        <span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_nested_template'>nested_template</span><span class='period'>.</span><span class='id identifier rubyid_outputs'>outputs</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_nested_template'>nested_template</span><span class='period'>.</span><span class='id identifier rubyid_outputs'>outputs</span><span class='period'>.</span><span class='id identifier rubyid_keys!'>keys!</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_oname'>oname</span><span class='op'>|</span>
      <span class='id identifier rubyid_output_map'>output_map</span><span class='lbracket'>[</span><span class='id identifier rubyid_oname'>oname</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_stack_name'>stack_name</span><span class='comma'>,</span> <span class='id identifier rubyid_oname'>oname</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_compiled_state-instance_method">
  
    #<strong>set_compiled_state</strong>(compiled)  &#x21d2; <tt>AttributeStruct</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Set the current compile_state into the
compiled result</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>compiled</span>
      
      
        <span class='type'>(<tt>AttributeStruct</tt>)</span>
      
      
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>AttributeStruct</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


25
26
27
28
29</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/sparkle_formation/provider/azure.rb', line 25</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_compiled_state'>set_compiled_state</span><span class='lparen'>(</span><span class='id identifier rubyid_compiled'>compiled</span><span class='rparen'>)</span>
  <span class='kw'>super</span>
  <span class='id identifier rubyid_compiled'>compiled</span><span class='period'>.</span><span class='id identifier rubyid_outputs'>outputs</span><span class='period'>.</span><span class='id identifier rubyid_compile_state'>compile_state</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>String</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_compiled'>compiled</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="stack_resource_type-instance_method">
  
    #<strong>stack_resource_type</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns Type string for Azure Resource Manager stack resource</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>Type string for Azure Resource Manager stack resource</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


9
10
11</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/sparkle_formation/provider/azure.rb', line 9</span>

<span class='kw'>def</span> <span class='id identifier rubyid_stack_resource_type'>stack_resource_type</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Microsoft.Resources/deployments</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Sat Jan 26 12:13:19 2019 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.16 (ruby-2.6.0).
</div>

    </div>
  </body>
</html>